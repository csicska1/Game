<!doctype html>
<html lang="hu">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Clean Dodge</title>

<style>
:root {
  --bg:#000;
  --surface2:#181818;
  --text:#fff;
  font-family:-apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", Arial, sans-serif;
}

html,body{
  margin:0;padding:0;height:100%;background:var(--bg);color:var(--text);
  -webkit-tap-highlight-color:transparent;
}

canvas{
  display:block;
  margin:0 auto;
  background:var(--surface2);
  border-radius:14px;
  box-shadow:0 0 30px rgba(0,0,0,.4);
}
</style>

</head>
<body>

<canvas id="c" width="360" height="640"></canvas>

<script>
const cfg={w:360,h:640,pw:42,ph:18,spd:5};
const c=document.getElementById("c"),x=c.getContext("2d");

const p={x:cfg.w/2-21,y:cfg.h-50,w:42,h:18,v:0};
let obs=[],input={l:false,r:false},score=0,run=true,last=0;

function spawn(){
  const w=20+Math.random()*50,ox=Math.random()*(cfg.w-w);
  obs.push({x:ox,y:-40,w:h=w,h:12+Math.random()*20,s:2+Math.random()*3});
}

function collide(a,b){
  return !(a.x+a.w<b.x||b.x+b.w<a.x||a.y+a.h<b.y||b.y+b.h<a.y);
}

function update(dt){
  if(input.l)p.v=-cfg.spd; else if(input.r)p.v=cfg.spd; else p.v=0;
  p.x+=p.v; p.x=Math.max(0,Math.min(cfg.w-p.w,p.x));

  if(Math.random()<0.01)spawn();

  for(let i=obs.length;i--;){
    let o=obs[i];
    o.y+=o.s;
    if(collide(p,o)){run=false;alert("Vesztettél! Pont: "+score);location.reload();}
    if(o.y>cfg.h){obs.splice(i,1);score++;}
  }
}

function draw(){
  // iPhone Dark háttér: mély, lágy gradient
  let g = x.createLinearGradient(0,0,0,cfg.h);
  g.addColorStop(0,"#000000");
  g.addColorStop(1,"#111111");
  x.fillStyle = g;
  x.fillRect(0,0,cfg.w,cfg.h);

  // Finom háttér "fény" kör a player körül
  let glow = x.createRadialGradient(p.x+p.w/2, p.y+p.h/2, 10, p.x+p.w/2, p.y+p.h/2, 140);
  glow.addColorStop(0,"rgba(48,209,88,0.25)");
  glow.addColorStop(1,"rgba(0,0,0,0)");
  x.fillStyle = glow;
  x.fillRect(0,0,cfg.w,cfg.h);

  // Player: kerekített, lágy glow
  x.shadowBlur = 18;
  x.shadowColor = "rgba(48,209,88,0.8)";
  x.fillStyle = "#30d158";
  x.beginPath();
  x.roundRect(p.x,p.y,p.w,p.h,8);
  x.fill();

  // Obstacles: élő, piros izzás
  x.shadowBlur = 14;
  x.shadowColor = "rgba(255,69,58,0.9)";
  x.fillStyle = "#ff453a";
  obs.forEach(o=>{
    x.beginPath();
    x.roundRect(o.x,o.y,o.w,o.h,6);
    x.fill();
  });

  // HUD szöveg: finom, nem ordít
  x.shadowBlur = 0;
  x.fillStyle = "rgba(255,255,255,0.85)";
  x.font = "18px -apple-system, BlinkMacSystemFont, SF Pro Display, sans-serif";
  x.fillText("Pont: "+score, 12, 26);
}


function loop(t){
  if(!last)last=t;
  const dt=t-last;last=t;
  if(run)update(dt),draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

document.addEventListener("touchstart",e=>{
  const x=e.touches[0].clientX;
  input.l=x<window.innerWidth/2;
  input.r=x>=window.innerWidth/2;
});
document.addEventListener("touchend",()=>{input.l=false;input.r=false;});
</script>

<script>
if("serviceWorker" in navigator){
  navigator.serviceWorker.register("./sw.js");
}
</script>

</body>
</html>